import{_ as n,c as s,o as a,a as t}from"./app.f1e974b0.js";const g='{"title":"VueRouter\u6E90\u78011: install \u5B89\u88C5","description":"","frontmatter":{},"headers":[{"level":2,"title":"\u8DEF\u7531\u57FA\u672C\u4F7F\u7528","slug":"\u8DEF\u7531\u57FA\u672C\u4F7F\u7528"},{"level":2,"title":"\u5B89\u88C5\u8DEF\u7531\u63D2\u4EF6 Vue.use(VueRouter)","slug":"\u5B89\u88C5\u8DEF\u7531\u63D2\u4EF6-vue-use-vuerouter"},{"level":3,"title":"Vue.use","slug":"vue-use"},{"level":3,"title":"VueRouter \u7684 install \u51FD\u6570","slug":"vuerouter-\u7684-install-\u51FD\u6570"}],"relativePath":"FE-Framework/vue-technology-source-code/vue-router-source-code-1-install.md"}',p={},o=t(`<h1 id="vuerouter\u6E90\u78011-install-\u5B89\u88C5" tabindex="-1">VueRouter\u6E90\u78011: install \u5B89\u88C5 <a class="header-anchor" href="#vuerouter\u6E90\u78011-install-\u5B89\u88C5" aria-hidden="true">#</a></h1><p><div class="table-of-contents"><ul><li><a href="#\u8DEF\u7531\u57FA\u672C\u4F7F\u7528">\u8DEF\u7531\u57FA\u672C\u4F7F\u7528</a></li><li><a href="#\u5B89\u88C5\u8DEF\u7531\u63D2\u4EF6-vue-use-vuerouter">\u5B89\u88C5\u8DEF\u7531\u63D2\u4EF6 Vue.use(VueRouter)</a><ul><li><a href="#vue-use">Vue.use</a></li><li><a href="#vuerouter-\u7684-install-\u51FD\u6570">VueRouter \u7684 install \u51FD\u6570</a></li></ul></li></ul></div></p><h2 id="\u8DEF\u7531\u57FA\u672C\u4F7F\u7528" tabindex="-1">\u8DEF\u7531\u57FA\u672C\u4F7F\u7528 <a class="header-anchor" href="#\u8DEF\u7531\u57FA\u672C\u4F7F\u7528" aria-hidden="true">#</a></h2><div class="language-html"><pre><code>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Hello App!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/info/13?q=keyword<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\u8BE6\u60C5\u9875<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-js"><pre><code><span class="token comment">// main.js</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token keyword">import</span> VueRouter <span class="token keyword">from</span> <span class="token string">&#39;vue-router&#39;</span>

<span class="token keyword">const</span> Info  <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">template</span><span class="token operator">:</span><span class="token string">&#39;&lt;div&gt;id:{{this.$route.params.id}}&lt;/div&gt;&#39;</span><span class="token punctuation">}</span>

<span class="token comment">/**
 * VueRouter \u4F7F\u7528
 */</span>

<span class="token comment">// 1. \u5B89\u88C5\u8DEF\u7531\u63D2\u4EF6</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>VueRouter<span class="token punctuation">)</span>

<span class="token comment">// 2. \u5B9A\u4E49\u8DEF\u7531</span>
<span class="token comment">// \u6BCF\u4E2A\u8DEF\u7531\u5E94\u8BE5\u6620\u5C04\u4E00\u4E2A\u7EC4\u4EF6\u3002 \u5176\u4E2D&quot;component&quot; \u53EF\u4EE5\u662F\u901A\u8FC7 Vue.extend() \u521B\u5EFA\u7684\u7EC4\u4EF6\u6784\u9020\u5668\uFF0C\u6216\u8005\u53EA\u662F\u4E00\u4E2A\u7EC4\u4EF6\u914D\u7F6E\u5BF9\u8C61\u3002</span>
<span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span><span class="token literal-property property">path</span><span class="token operator">:</span><span class="token string">&#39;/info/:id&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;info&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">component</span><span class="token operator">:</span>Info<span class="token punctuation">}</span>
<span class="token punctuation">]</span>

<span class="token comment">// 3. \u521B\u5EFA router \u5B9E\u4F8B</span>
<span class="token comment">// \u4EE5\u5B9A\u4E49\u7684 routes \u914D\u7F6E\u521B\u5EFA\u8DEF\u7531\u5668\u5B9E\u4F8B router\u3002</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  routes
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 4. \u5C06\u8DEF\u7531\u5668\u5B9E\u4F8B router \u4F20\u5165 Vue \u5B9E\u4F8B\u5316\u9009\u9879\u4E2D\u3002\u4ECE\u800C\u8BA9\u6574\u4E2A\u5E94\u7528\u90FD\u6709\u8DEF\u7531\u529F\u80FD</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">el</span><span class="token operator">:</span> <span class="token string">&#39;#app&#39;</span><span class="token punctuation">,</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">h</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">h</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  router
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="\u5B89\u88C5\u8DEF\u7531\u63D2\u4EF6-vue-use-vuerouter" tabindex="-1">\u5B89\u88C5\u8DEF\u7531\u63D2\u4EF6 Vue.use(VueRouter) <a class="header-anchor" href="#\u5B89\u88C5\u8DEF\u7531\u63D2\u4EF6-vue-use-vuerouter" aria-hidden="true">#</a></h2><h3 id="vue-use" tabindex="-1">Vue.use <a class="header-anchor" href="#vue-use" aria-hidden="true">#</a></h3><p>Vue \u63D0\u4F9B\u4E86 <code>Vue.use</code> \u7684\u5168\u5C40 API \u6765\u6CE8\u518C\u8FD9\u4E9B\u63D2\u4EF6\uFF0C\u51FD\u6570\u8DEF\u5F84: <code>installGlobalAPI(Vue) =&gt; initUse(Vue)</code></p><div class="language-js"><pre><code><span class="token comment">/**
 * \u63D2\u4EF6\u6CE8\u518C Vue.use(plugin)
 * 
 * Vue.use \u63A5\u53D7\u4E00\u4E2A plugin \u53C2\u6570\uFF0C\u5E76\u4E14\u7EF4\u62A4\u4E86\u4E00\u4E2A _installedPlugins \u6570\u7EC4\uFF0C\u5B83\u5B58\u50A8\u6240\u6709\u6CE8\u518C\u8FC7\u7684 plugin\uFF1B
 * 1. \u5982\u679C\u7F13\u5B58\u63D2\u4EF6\u7684\u6570\u7EC4\u4E2D\u5DF2\u6709\uFF0C\u5219\u8BF4\u660E\u8BE5\u63D2\u4EF6\u5DF2\u6CE8\u518C\u8FC7\uFF0C\u76F4\u63A5\u8FD4\u56DE
 * 2. \u51FD\u6570\u4E2D\u5224\u65AD plugin \u6709\u6CA1\u6709\u5B9A\u4E49 install \u65B9\u6CD5\uFF0C\u5982\u679C\u6709\u7684\u8BDD\u5219\u8C03\u7528\u8BE5\u65B9\u6CD5\uFF0C\u5E76\u4E14\u8BE5\u65B9\u6CD5\u6267\u884C\u7684\u7B2C\u4E00\u4E2A\u53C2\u6570\u662F Vue\uFF1B
 * 3. \u5982\u679C plugin \u6CA1\u6709\u5B9A\u4E49 install \u65B9\u6CD5\uFF0C\u5219\u81EA\u8EAB\u5FC5\u987B\u662F\u4E00\u4E2A\u63A5\u53D7 vue \u5165\u53C2\u7684\u51FD\u6570\u3002
 * 4. \u6700\u540E\u628A plugin \u5B58\u50A8\u5230 installedPlugins \u4E2D\u3002
 */</span> 

<span class="token keyword">function</span> <span class="token function">initUse</span> <span class="token punctuation">(</span><span class="token parameter">Vue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  Vue<span class="token punctuation">.</span><span class="token function-variable function">use</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">plugin</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> installedPlugins <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_installedPlugins <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_installedPlugins <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>installedPlugins<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>plugin<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token function">toArray</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u8FD4\u56DE\u7A7A\u6570\u7EC4 []</span>
    args<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [Vue]</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> plugin<span class="token punctuation">.</span>install <span class="token operator">===</span> <span class="token string">&#39;function&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      plugin<span class="token punctuation">.</span><span class="token function">install</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>plugin<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> plugin <span class="token operator">===</span> <span class="token string">&#39;function&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">plugin</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    installedPlugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>plugin<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="vuerouter-\u7684-install-\u51FD\u6570" tabindex="-1">VueRouter \u7684 install \u51FD\u6570 <a class="header-anchor" href="#vuerouter-\u7684-install-\u51FD\u6570" aria-hidden="true">#</a></h3><ol><li>install.installed \u6807\u8BC6\u81EA\u8EAB\u662F\u5426\u5DF2\u6CE8\u518C\u8FC7</li><li>Vue.mixin \u5168\u5C40\u6DF7\u5165 beforeCreate \u548C destoryed \u751F\u547D\u5468\u671F\u94A9\u5B50\u51FD\u6570\uFF0C\u4F1A\u5728\u6BCF\u4E2A\u7EC4\u4EF6\u5B9E\u4F8B\u5316\u65F6\u90FD\u6DF7\u5165\u3002\u4F46\u53EA\u5728 new Vue \u5B9E\u4F8B\u5316\u65F6\u8FDB\u884C\u4EE5\u4E0B\u5173\u952E\u6B65\u9AA4\uFF1A <ol><li>\u8BBE\u7F6E\u53D8\u91CF <code>this._routerRoot = this</code>\uFF0C\u5373\u5E94\u7528\u5B9E\u4F8B app\uFF0C\u8BA9\u7EC4\u4EF6\u5B9E\u4F8B\u5316\u65F6\u901A\u8FC7 <code>this._routerRoot = (this.$parent &amp;&amp; this.$parent._routerRoot)</code> \u83B7\u53D6\u5230\u5E94\u7528\u5B9E\u4F8B app</li><li><code>this._router = this.$options.router;</code> \u5728\u6839\u5B9E\u4F8B\u5373\u5E94\u7528\u5B9E\u4F8B\u4E0A\u4FDD\u5B58\u552F\u4E00\u7684\u8DEF\u7531\u5668\u5B9E\u4F8B router</li><li><code>this._router.init(this)</code> \u6267\u884C\u8DEF\u7531\u521D\u59CB\u5316\uFF0C\u5185\u90E8\u903B\u8F91\u5305\u62EC\u8DEF\u7531\u914D\u7F6E\u89E3\u6790\u751F\u6210\u8DEF\u7531\u8BB0\u5F55\u548C\u6CE8\u518C\u8DEF\u7531\u76D1\u542C\u4E8B\u4EF6</li><li><code>Vue.util.defineReactive(this, &#39;_route&#39;, this._router.history.current)</code> \u8DEF\u7531\u53D8\u5316\u80FD\u89E6\u53D1\u89C6\u56FE\u66F4\u65B0\u7684\u6838\u5FC3\u4EE3\u7801\uFF0C\u5373\u5728\u6839\u5B9E\u4F8B\u4E0A\u5B9A\u4E49\u4E00\u4E2A\u54CD\u5E94\u5F0F\u7684\u53D8\u91CF _route</li></ol></li><li>\u5728 Vue.prototype \u539F\u578B\u5BF9\u8C61\u4E0A\u5B9A\u4E49\u4E24\u4E2A\u53EA\u8BFB\u7684 $router / $route\uFF0C\u66B4\u9732\u7ED9\u5168\u5C40\u4F7F\u7528\u3002</li><li>\u6CE8\u518C\u8DEF\u7531\u5165\u53E3 RouterLink \u548C \u8DEF\u7531\u51FA\u53E3 RouterView \u7EC4\u4EF6\u3002</li></ol><div class="language-js"><pre><code><span class="token keyword">var</span> _Vue<span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">install</span> <span class="token punctuation">(</span><span class="token parameter">Vue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// install.installed \u6807\u8BC6\u81EA\u8EAB\u662F\u5426\u5DF2\u6CE8\u518C\u8FC7\uFF0C\u5DF2\u6CE8\u518C\u8FC7\u65E0\u9700\u91CD\u590D\u6CE8\u518C</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>install<span class="token punctuation">.</span>installed <span class="token operator">&amp;&amp;</span> _Vue <span class="token operator">===</span> Vue<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">}</span>
  install<span class="token punctuation">.</span>installed <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

  _Vue <span class="token operator">=</span> Vue<span class="token punctuation">;</span>
  Vue<span class="token punctuation">.</span><span class="token function">mixin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function-variable function">beforeCreate</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">beforeCreate</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isDef</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$options<span class="token punctuation">.</span>router<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// \u6B64\u65F6\u662F new Vue \u5B9E\u4F8B\u5316\u6839\u5B9E\u4F8B\u65F6</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_routerRoot <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token comment">// \u5F53\u524D\u7EC4\u4EF6\u5B9E\u4F8B vm</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_router <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$options<span class="token punctuation">.</span>router<span class="token punctuation">;</span> <span class="token comment">// new Vue \u65F6\u4F20\u5165\u7684 new VueRouter \u5B9E\u4F8B</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_router<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u8DEF\u7531\u521D\u59CB\u5316</span>
        Vue<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">defineReactive</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">&#39;_route&#39;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_router<span class="token punctuation">.</span>history<span class="token punctuation">.</span>current<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">/**
         * this._route = {
         *  get () {
         *    var value = this._router.history.current
         *    if (Dep.target) { dep.depend() }
         *    return value
         *  },
         *  set (newVal) {
         *    var value = this._router.history.current
         *    val = newValue
         *     dep.notify()
         *  }
         * }
         */</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// \u5176\u5B83\u7EC4\u4EF6\u5B9E\u4F8B\u5316\u65F6\uFF0C\u4FDD\u5B58\u4ECE\u7236\u7EC4\u4EF6\u4E0A\u83B7\u53D6\u6839\u5B9E\u4F8B app\uFF0C\u56E0\u4E3A\u53EA\u6709\u6839\u5B9E\u4F8B\u4E0A\u624D\u542B\u6709\u8DEF\u7531\u4FE1\u606F</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_routerRoot <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$parent <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$parent<span class="token punctuation">.</span>_routerRoot<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token function">registerInstance</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">destroyed</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">destroyed</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">registerInstance</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// \u5728 Vue.prototype \u539F\u578B\u5BF9\u8C61\u4E0A\u5B9A\u4E49\u4E24\u4E2A\u53EA\u8BFB\u7684 $router / $route</span>
  Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span><span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">,</span> <span class="token string">&#39;$router&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">get</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_routerRoot<span class="token punctuation">.</span>_router <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span><span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">,</span> <span class="token string">&#39;$route&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">get</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_routerRoot<span class="token punctuation">.</span>_route <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// \u6CE8\u518C \u8DEF\u7531\u5165\u53E3 RouterLink \u548C \u8DEF\u7531\u51FA\u53E3 RouterView \u7EC4\u4EF6</span>
  Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">&#39;RouterView&#39;</span><span class="token punctuation">,</span> View<span class="token punctuation">)</span><span class="token punctuation">;</span>
  Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">&#39;RouterLink&#39;</span><span class="token punctuation">,</span> Link<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> strats <span class="token operator">=</span> Vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>optionMergeStrategies<span class="token punctuation">;</span>
  strats<span class="token punctuation">.</span>beforeRouteEnter <span class="token operator">=</span> strats<span class="token punctuation">.</span>beforeRouteLeave <span class="token operator">=</span> strats<span class="token punctuation">.</span>beforeRouteUpdate <span class="token operator">=</span> strats<span class="token punctuation">.</span>created<span class="token punctuation">;</span>


  <span class="token comment">// helper</span>
  <span class="token keyword">function</span> <span class="token function">isDef</span> <span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> v <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">registerInstance</span> <span class="token punctuation">(</span><span class="token parameter">vm<span class="token punctuation">,</span> callVal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> i <span class="token operator">=</span> vm<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>_parentVnode<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isDef</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isDef</span><span class="token punctuation">(</span>i <span class="token operator">=</span> i<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isDef</span><span class="token punctuation">(</span>i <span class="token operator">=</span> i<span class="token punctuation">.</span>registerRouteInstance<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">i</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> callVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>\u603B\u7ED3\uFF1A</p><ol><li>VueRouter \u7684 install \u51FD\u6570\u5173\u952E\u7684\u662F\u8DEF\u7531\u5B9E\u4F8B\u7684 init \u51FD\u6570 \u548C _route \u54CD\u5E94\u5F0F\u53D8\u91CF\u51FD\u6570\u3002</li><li>\u6BCF\u4E2A\u7EC4\u4EF6\u5B9E\u4F8B\u5316\u65F6\u6267\u884C beforeCreate \u51FD\u6570\uFF0C\u5373\u6BCF\u4E2A\u7EC4\u4EF6\u90FD\u6301\u6709 _routerRoot \u53D8\u91CF\uFF0C\u4E5F\u5C31\u95F4\u63A5\u80FD\u8BBF\u95EE\u5230\u5168\u5C40\u7684\u8DEF\u7531\u4FE1\u606F\u3002</li></ol>`,14),e=[o];function c(u,l,i,k,r,d){return a(),s("div",null,e)}var y=n(p,[["render",c]]);export{g as __pageData,y as default};
