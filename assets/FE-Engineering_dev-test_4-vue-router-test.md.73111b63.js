import{_ as n,c as s,o as a,a as t}from"./app.fa011131.js";const m='{"title":"\u6D4B\u8BD5 Vue-Router","description":"","frontmatter":{},"headers":[{"level":2,"title":"\u4F7F\u7528 router \u5B9E\u4F8B\u6D4B\u8BD5","slug":"\u4F7F\u7528-router-\u5B9E\u4F8B\u6D4B\u8BD5"},{"level":2,"title":"mock \u8DEF\u7531\u5BF9\u8C61 route \u6D4B\u8BD5","slug":"mock-\u8DEF\u7531\u5BF9\u8C61-route-\u6D4B\u8BD5"},{"level":2,"title":"mock \u8DEF\u7531\u5668\u5BF9\u8C61 router \u6D4B\u8BD5","slug":"mock-\u8DEF\u7531\u5668\u5BF9\u8C61-router-\u6D4B\u8BD5"},{"level":2,"title":"\u6D4B\u8BD5 RouterLink \u7EC4\u4EF6","slug":"\u6D4B\u8BD5-routerlink-\u7EC4\u4EF6"},{"level":2,"title":"\u603B\u7ED3","slug":"\u603B\u7ED3"}],"relativePath":"FE-Engineering/dev-test/4-vue-router-test.md"}',p={},o=t(`<h1 id="\u6D4B\u8BD5-vue-router" tabindex="-1">\u6D4B\u8BD5 Vue-Router <a class="header-anchor" href="#\u6D4B\u8BD5-vue-router" aria-hidden="true">#</a></h1><p>\u7531\u4E8E\u8DEF\u7531\u901A\u5E38\u4F1A\u628A\u591A\u4E2A\u7EC4\u4EF6\u7275\u626F\u5230\u4E00\u8D77\u64CD\u4F5C\uFF0C\u6240\u4EE5\u4E00\u822C\u5BF9\u5176\u529F\u80FD\u7684\u6D4B\u8BD5\u90FD\u4F1A\u7B49\u5230\u7AEF\u5230\u7AEF\u7684\u96C6\u6210\u6D4B\u8BD5\u9636\u6BB5\u8FDB\u884C\uFF0C\u4E0D\u8FC7\uFF0C\u5BF9\u7EC4\u4EF6\u4E2D\u4F7F\u7528\u5230\u7684\u90E8\u5206\u8DEF\u7531\u529F\u80FD\u505A\u4E00\u4E9B\u5355\u5143\u6D4B\u8BD5\u8FD8\u662F\u5927\u6709\u88E8\u76CA\u7684\u3002</p><p>\u7EC4\u4EF6\u4E0E\u8DEF\u7531\u7684\u4EA4\u4E92\u4E3B\u8981\u5B58\u5728\uFF1A</p><ul><li><code>$route</code> \u5BF9\u8C61\u5305\u542B\u4E86\u5F53\u524D\u5339\u914D\u8DEF\u7531\u7684\u4FE1\u606F\uFF0C\u5BF9\u5B83\u7684\u4E3B\u8981\u6D4B\u8BD5\u9879\u5728\u4E8E\u52A8\u6001\u8DEF\u7531\u53C2\u6570\u3001\u8DEF\u7531\u7684\u67E5\u8BE2\u53C2\u6570\u662F\u5426\u7B26\u5408\u9884\u671F\u3002</li><li><code>$router</code> \u5BF9\u8C61\u5305\u542B\u4E86\u63A7\u5236\u8DEF\u7531\u8DF3\u8F6C\u7684\u65B9\u6CD5\uFF0C\u5BF9\u5B83\u7684\u4E3B\u8981\u6D4B\u8BD5\u5728\u4E8E\u6A21\u62DF\u5B83\u7684\u8DF3\u8F6C\u65B9\u6CD5\uFF0C\u65AD\u8A00\u5176\u65B9\u6CD5\u662F\u5426\u8C03\u7528\u3002\u81F3\u4E8E\u771F\u5B9E\u7684\u8DEF\u7531\u8DF3\u8F6C\u53EF\u4EE5\u653E\u5728\u96C6\u6210\u6D4B\u8BD5\u4E2D\u5B9E\u73B0\u3002</li><li><code>RouterLink</code> \u7EC4\u4EF6\u4E3B\u8981\u5728\u4E8E\u6D4B\u8BD5\u5176 <code>to</code> \u5C5E\u6027\u503C\u662F\u5426\u6B63\u786E\u3002</li></ul><h2 id="\u4F7F\u7528-router-\u5B9E\u4F8B\u6D4B\u8BD5" tabindex="-1">\u4F7F\u7528 router \u5B9E\u4F8B\u6D4B\u8BD5 <a class="header-anchor" href="#\u4F7F\u7528-router-\u5B9E\u4F8B\u6D4B\u8BD5" aria-hidden="true">#</a></h2><div class="language-vue"><pre><code><span class="token comment">&lt;!-- App.vue --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;app&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- About.vue --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>\u7528\u6237ID\uFF1A{{ userId }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;About&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">computed</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">userId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>\u521B\u5EFA\u8DEF\u7531</p><div class="language-js"><pre><code><span class="token comment">// routes.js</span>
<span class="token keyword">import</span> About <span class="token keyword">from</span> <span class="token string">&#39;src/components/About.vue&#39;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&#39;/user/:id&#39;</span><span class="token punctuation">,</span> <span class="token comment">// \u52A8\u6001\u8DEF\u7531</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span> About<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre></div><p>\u5728\u771F\u5B9E\u9879\u76EE\u4EE3\u7801\u4E2D\uFF0C\u4F1A\u5728 <code>main.js</code> \u4E2D\u6CE8\u518C\u8DEF\u7531</p><div class="language-js"><pre><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token keyword">import</span> VueRouter <span class="token keyword">from</span> <span class="token string">&#39;vue-router&#39;</span>
<span class="token keyword">import</span> routes <span class="token keyword">from</span> <span class="token string">&#39;./routes.js&#39;</span>

Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>VueRouter<span class="token punctuation">)</span>

<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span> routes <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">el</span><span class="token operator">:</span> <span class="token string">&#39;#app&#39;</span><span class="token punctuation">,</span>
  router<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>\u540C\u524D\u9762 <code>vuex</code> \u6240\u5EDB\u7684<strong>\u6D4B\u8BD5\u6CC4\u9732</strong>\u95EE\u9898\u4E00\u6837\uFF0C\u5728\u6D4B\u8BD5\u6587\u4EF6\uFF0C\u4E3A\u4E86\u907F\u514D <code>Vue.use(VueRouter)</code>\u6C61\u67D3\u6D4B\u8BD5\u7528\u4F8B\u5171\u4EAB\u7684\u5168\u5C40\u552F\u4E00 Vue \u57FA\u7840\u6784\u9020\u51FD\u6570\uFF0C\u6211\u4EEC\u5E94\u8BE5\u4F7F\u7528<code>@vue/test-utils</code>\u6D4B\u8BD5\u5957\u4EF6\u63D0\u4F9B\u7684 <code>createLocalVue</code> \u51FD\u6570\u521B\u5EFA\u672C\u5730\u7684 Vue \u526F\u672C\u6765\u6CE8\u518C\u5168\u5C40\u4F9D\u8D56\u3002</p><p>\u6240\u4EE5\u4E3A\u4E86\u6D4B\u8BD5 <code>About</code> \u7EC4\u4EF6\u6E32\u67D3\u65F6\u662F\u5426\u5F97\u5230\u4E86\u9884\u671F\u7684\u52A8\u6001\u53C2\u6570\uFF0C\u7F16\u5199\u5982\u4E0B\u5355\u5143\u6D4B\u8BD5</p><div class="language-js"><pre><code><span class="token keyword">import</span> <span class="token punctuation">{</span> shallowMount<span class="token punctuation">,</span> mount<span class="token punctuation">,</span> createLocalVue <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@vue/test-utils&#39;</span>
<span class="token keyword">import</span> VueRouter <span class="token keyword">from</span> <span class="token string">&#39;vue-router&#39;</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">&#39;src/App.vue&#39;</span>
<span class="token keyword">import</span> About <span class="token keyword">from</span> <span class="token string">&#39;src/components/About.vue&#39;</span>
<span class="token keyword">import</span> routes <span class="token keyword">from</span> <span class="token string">&#39;@/routes.js&#39;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#39;About.vue&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> localVue <span class="token operator">=</span> <span class="token function">createLocalVue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  localVue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>VueRouter<span class="token punctuation">)</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#39;renders About via routing&#39;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    expect<span class="token punctuation">.</span><span class="token function">assertions</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span> routes <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>App<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      localVue<span class="token punctuation">,</span>
      router<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&#39;/user/1&#39;</span><span class="token punctuation">)</span>
    <span class="token keyword">await</span> wrapper<span class="token punctuation">.</span>vm<span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// \u7B49\u5F85\u5F02\u6B65\u6E32\u67D3\u5B8C\u6210</span>

    <span class="token keyword">const</span> About <span class="token operator">=</span> wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>About<span class="token punctuation">)</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>About<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>About<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token string">&#39;1&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>\u8FD9\u91CC\u6709\u4E24\u4E2A\u6CE8\u610F\u70B9\uFF1A</p><ul><li>\u7528\u4E86 <code>mount</code> \u800C\u975E <code>shallowMount</code>\u3002\u5982\u679C\u7528\u4E86 <code>shallowMount</code>\uFF0C\u5219 <code>&lt;router-view&gt;</code> \u5C31\u4F1A\u88AB\u5FFD\u7565\uFF0C\u4E0D\u7BA1\u5F53\u524D\u8DEF\u7531\u662F\u4EC0\u4E48\uFF0C\u6E32\u67D3\u7684\u5176\u5B9E\u90FD\u662F\u4E00\u4E2A\u65E0\u7528\u7684 stubted \u540E\u7684\u7EC4\u4EF6<code>routerveiw-stub</code>\u3002</li><li>\u4F7F\u7528\u5F02\u6B65\u6D4B\u8BD5 <code>await wrapper.vm.$nextTick()</code>\uFF0C\u9700\u8981\u5F02\u6B65\u7B49\u5F85\u5E94\u7528\u6E32\u67D3\u540E\u518D\u65AD\u8A00</li></ul><p>\u6B63\u56E0\u4E3A\u9700\u8981\u6CE8\u610F\u4E0A\u9762\u4E24\u4E2A\u6CE8\u610F\u7684\u65B9\u9762\uFF0C\u4F1A\u5BFC\u81F4\u6D4B\u8BD5\u7528\u4F8B\u4F9D\u8D56\u8FC7\u4E8E\u590D\u6742\u3002\u50CF\u4E0A\u9762\u8FD9\u6837\u4F7F\u7528 <code>mount</code> \u6E32\u67D3\u6574\u4E2A APP \u7EC4\u4EF6\u65F6\uFF0C\u6B63\u8D76\u4E0A\u6E32\u67D3\u6811\u5F88\u5927\uFF0C\u5305\u542B\u4E86\u8BB8\u591A\u7EC4\u4EF6\uFF0C\u4E00\u5C42\u5C42\u7684\u7EC4\u4EF6\u53C8\u6709\u81EA\u5DF1\u7684\u5B50\u7EC4\u4EF6\u3002\u8FD9\u4E9B\u4E2A\u5B50\u7EC4\u4EF6\u90FD\u8981\u89E6\u53D1\u5404\u79CD\u751F\u547D\u5468\u671F\u94A9\u5B50\u3001\u53D1\u8D77 API \u8BF7\u6C42\u4EC0\u4E48\u7684\u4E4B\u7C7B\u7684\u573A\u666F\u3002\u6240\u4EE5\u8FD9\u79CD\u6D4B\u8BD5\u8303\u56F4\u90FD\u5C5E\u4E8E\u96C6\u6210\u6D4B\u8BD5\uFF0C\u5728 e2e \u6D4B\u8BD5\u6846\u67B6\u5185\u5B8C\u6210\u3002</p><p>\u6240\u4EE5\u4E0A\u9762\u8FD9\u79CD\u5C06\u6574\u4E2A router \u5B9E\u4F8B\u4F5C\u4E3A\u5355\u5143\u6D4B\u8BD5\u7684\u65B9\u5F0F\u5E76\u4E0D\u53EF\u80FD\u91C7\u7528\u3002\u66F4\u591A\u7684\u662F\u4F7F\u7528\u6D4B\u8BD5\u5957\u4EF6\u63D0\u4F9B\u7684 <code>mocks</code> \u6302\u8F7D\u9009\u9879\u6765\u6A21\u62DF\u5168\u5C40\u7684 <code>$route / $router</code> \u5C5E\u6027\u6765\u6D4B\u8BD5\u3002</p><h2 id="mock-\u8DEF\u7531\u5BF9\u8C61-route-\u6D4B\u8BD5" tabindex="-1">mock \u8DEF\u7531\u5BF9\u8C61 route \u6D4B\u8BD5 <a class="header-anchor" href="#mock-\u8DEF\u7531\u5BF9\u8C61-route-\u6D4B\u8BD5" aria-hidden="true">#</a></h2><p>\u5BF9\u4E8E <code>About</code> \u7EC4\u4EF6\u7684\u6D4B\u8BD5\u65AD\u8A00\u662F\uFF1A\u8F93\u5165\u4E00\u4E2A\u80FD\u89E3\u6790\u5230\u52A8\u6001\u8DEF\u7531\u53C2\u6570\u7684\u5BF9\u8C61\uFF0C\u8F93\u51FA\u662F\u5728\u7EC4\u4EF6\u5185\u89C6\u56FE\u6E32\u67D3\u51FA\u9884\u671F\u7684\u52A8\u6001\u53C2\u6570\u3002</p><p>\u5C06\u4E0A\u9762\u4F8B\u5B50\u6539\u7528\u4E0B\u9762\u7684\u6D4B\u8BD5\u4EE3\u7801:</p><div class="language-js"><pre><code><span class="token keyword">import</span> About <span class="token keyword">from</span> <span class="token string">&#39;src/components/About.vue&#39;</span>
<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#39;About.vue&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;render id param&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> mockRoute <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">$route</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">123</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">shallowMount</span><span class="token punctuation">(</span>About<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">mocks</span><span class="token operator">:</span> MockRoute<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token string">&#39;123&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>\u53EF\u4EE5\u770B\u5230\u6D4B\u8BD5\u4EE3\u7801\u6BD4\u4F7F\u7528 router \u5B9E\u4F8B\u65F6\u7B80\u6D01\u4E86\u8BB8\u591A\u3002</p><h2 id="mock-\u8DEF\u7531\u5668\u5BF9\u8C61-router-\u6D4B\u8BD5" tabindex="-1">mock \u8DEF\u7531\u5668\u5BF9\u8C61 router \u6D4B\u8BD5 <a class="header-anchor" href="#mock-\u8DEF\u7531\u5668\u5BF9\u8C61-router-\u6D4B\u8BD5" aria-hidden="true">#</a></h2><p><code>$router</code> \u5BF9\u8C61\u5305\u542B\u4E86\u63A7\u5236\u8DEF\u7531\u8DF3\u8F6C\u7684\u65B9\u6CD5\uFF0C\u5BF9\u5B83\u7684\u4E3B\u8981\u6D4B\u8BD5\u5728\u4E8E\u6A21\u62DF\u5B83\u7684\u8DF3\u8F6C\u65B9\u6CD5\uFF0C\u65AD\u8A00\u5176\u65B9\u6CD5\u662F\u5426\u8C03\u7528\u3002\u81F3\u4E8E\u771F\u5B9E\u7684\u8DEF\u7531\u8DF3\u8F6C\u529F\u80FD\u53EF\u4EE5\u653E\u5728\u96C6\u6210\u6D4B\u8BD5\u4E2D\u5B9E\u73B0\u3002</p><p>\u8DDF\u4E0A\u9762 <code>$route</code> \u6D4B\u8BD5\u4E00\u6837\uFF0C\u6CA1\u6709\u5FC5\u8981\u521B\u5EFA\u4E00\u4E2A\u771F\u5B9E\u7684\u8DEF\u7531\u5668\u5B9E\u4F8B\u6765\u6D4B\u8BD5 <code>$router.push</code> \u4E4B\u7C7B\u7684\u65B9\u6CD5\uFF0C\u540C\u6837\u53EF\u4EE5\u4F7F\u7528 <code>mocks</code> \u6765\u6A21\u62DF\u65B9\u6CD5\uFF0C\u5E76\u65AD\u8A00\u6A21\u62DF\u65B9\u6CD5\u7684\u6267\u884C\u548C\u5165\u53C2\u3002</p><p>\u6539\u9020\u4E00\u4E0B <code>About</code> \u7EC4\u4EF6\uFF0C\u589E\u52A0\u4E00\u4E2A\u80FD\u8DF3\u8F6C\u9996\u9875\u7684\u6309\u94AE\u3002</p><div class="language-vue"><pre><code><span class="token comment">&lt;!-- About.vue --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>\u7528\u6237ID\uFF1A{{ userId }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>goHome<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\u9996\u9875<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;About&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">computed</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">userId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">goHome</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&#39;/home&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>\u7ED3\u5408\u4E0A\u4E00\u4E2A\u5355\u5143\u6D4B\u8BD5\u4EE3\u7801\uFF0C\u5BF9\u4EE3\u7801\u91CD\u6784\u4E3A\uFF1A</p><div class="language-js"><pre><code><span class="token keyword">import</span> About <span class="token keyword">from</span> <span class="token string">&quot;src/components/About.vue&quot;</span>
<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#39;About.vue&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token comment">// \u751F\u6210\u6A21\u62DF\u6570\u636E</span>
  <span class="token keyword">const</span> mockObj <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">$route</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">parmas</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">123</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">$router</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">push</span><span class="token operator">:</span> jest<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">shallowMount</span><span class="token punctuation">(</span>About<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">mocks</span><span class="token operator">:</span> mockObj<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;render id param&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token string">&#39;123&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;calls $router.push(&quot;/home&quot;) when button is clicked&#39;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> btn <span class="token operator">=</span> wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">&#39;button&#39;</span><span class="token punctuation">)</span>
    <span class="token keyword">await</span> btn<span class="token punctuation">.</span><span class="token function">triiger</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">)</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>mockObj<span class="token punctuation">.</span>$router<span class="token punctuation">.</span>push<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveBeenCalledWith</span><span class="token punctuation">(</span><span class="token string">&#39;/home&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">}</span>
</code></pre></div><h2 id="\u6D4B\u8BD5-routerlink-\u7EC4\u4EF6" tabindex="-1">\u6D4B\u8BD5 RouterLink \u7EC4\u4EF6 <a class="header-anchor" href="#\u6D4B\u8BD5-routerlink-\u7EC4\u4EF6" aria-hidden="true">#</a></h2><p>\u5728 <code>VueRouter</code> \u4E2D\u8FDB\u884C\u8DEF\u7531\u8DF3\u8F6C\uFF0C\u9664\u4E86\u50CF\u4E0A\u9762\u8C03\u7528<code>$router.push</code>\u7684\u7F16\u7A0B\u5F0F\u5BFC\u822A\u5916\uFF0C\u8FD8\u63D0\u4F9B\u4E86<code>&lt;router-link&gt;</code>\u7684\u7EC4\u4EF6\u5F0F\u5BFC\u822A\u3002</p><p>\u6BD4\u5982\u4E0A\u8FF0\u8DF3\u8F6C\u5230\u9996\u9875\u53EF\u4EE5\u5199\u6210\uFF1A</p><div class="language-html"><pre><code><span class="token comment">&lt;!-- About.vue --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>\u7528\u6237ID\uFF1A{{userId}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- &lt;button @click=&quot;goHome&quot;&gt;\u9996\u9875&lt;/button&gt; --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/home<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\u9996\u9875<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>\u8981\u6D4B\u8BD5\u8FD9\u4E2A\u7EC4\u4EF6\u94FE\u63A5\u662F\u5426\u6709\u6548\uFF0C\u5E38\u89C4\u4E0B\u4F1A\u6709\u4EE5\u4E0B\u4E24\u79CD\u64CD\u4F5C\uFF1A</p><p>\u7B2C\u4E00\u79CD\uFF1A\u4EE5\u521B\u5EFA <code>router</code> \u5B9E\u4F8B\uFF0C\u5E76\u4E14\u4F7F\u7528 <code>mount</code> \u6E32\u67D3 <code>About</code> \u7EC4\u4EF6\uFF0C\u56E0\u4E3A <code>router-link</code> \u7EC4\u4EF6\u6700\u7EC8\u4F1A\u88AB\u6E32\u67D3\u6210 <code>&lt;a href=&quot;/home&quot;&gt;\u9996\u9875&lt;/a&gt;</code>\uFF0C\u6240\u4EE5\u901A\u8FC7 find \u9009\u62E9\u5668\u67E5\u627E a \u6807\u7B7E\uFF0C\u65AD\u8A00 a \u5143\u7D20\u7684 href \u5C5E\u6027\u662F\u662F\u5426\u6B63\u786E\u3002\u4F46\u56E0\u4E3A\u540C\u6837\u7684\u539F\u56E0\uFF0C\u5B9E\u4F8B\u6D4B\u8BD5\u4E2D\u4F1A\u5C3D\u91CF\u907F\u514D\u4F7F\u7528 mount \u6302\u8F7D\u7EC4\u4EF6\u3002 \u7B2C\u4E8C\u79CD\uFF1A\u4F7F\u7528\u3CC0\u6E32\u67D3 <code>shallowMount</code> \u6302\u8F7D <code>About</code> \u7EC4\u4EF6\uFF0C\u5982\u679C\u662F\u666E\u901A\u5B50\u7EC4\u4EF6\uFF0C\u6211\u4EEC\u53EF\u4EE5\u901A\u8FC7 <code>findComponent(com).props(&#39;to&#39;).toBe(&#39;/home&#39;)</code> \u8FDB\u884C\u65AD\u8A00\u3002\u4F46\u8FD9\u91CC\u7684\u95EE\u9898\u662F\u6211\u4EEC\u6CA1\u6709\u529E\u6CD5\u53EF\u4EE5\u83B7\u53D6\u5230 <code>RouterLink</code> \u7EC4\u4EF6\u6784\u9020\u5668\uFF0C\u6240\u4EE5\u65E0\u6CD5\u7528\u5B83\u4F5C\u4E3A <code>findComponent</code> \u51FD\u6570\u7684\u5165\u53C2\u6765\u8FDB\u884C\u65AD\u8A00\u3002</p><p>\u89E3\u51B3\u529E\u6CD5\u5C31\u662F <code>@vue/test-utils</code> \u63D0\u4F9B\u4E86\u4E00\u4E2A <code>RouterLinkStub</code> \u5BF9\u8C61\u53EF\u4EE5\u5B8C\u5168\u6A21\u62DF <code>RouterLink</code>\u3002</p><div class="language-js"><pre><code><span class="token keyword">import</span> <span class="token punctuation">{</span> shallowMount<span class="token punctuation">,</span> RouterLinkStub <span class="token punctuation">}</span> <span class="token keyword">from</span> &#39;@vue<span class="token operator">/</span>test<span class="token operator">-</span>utils
<span class="token keyword">import</span> About <span class="token keyword">from</span> <span class="token string">&#39;src/components/About.vue&#39;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#39;RouterLink&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;renders RouterLink&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">shallowMount</span><span class="token punctuation">(</span>About<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">stubs</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">RouterLink</span><span class="token operator">:</span> RouterLinkStub<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">findComponent</span><span class="token punctuation">(</span>RouterLinkStub<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">props</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">&#39;/home&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><code>stubs</code>\u6302\u8F7D\u9009\u9879\u544A\u8BC9\u4E86<code>shallowMout</code>\u5982\u4F55\u6A21\u62DF\u5185\u90E8\u5B50\u7EC4\u4EF6\u7684\u6E32\u67D3\u3002</p><p>\u6BD4\u5982\uFF0C\u524D\u9762\u5728\u8BB2 <code>mount / shallowMount</code> \u6302\u8F7D\u5305\u542B\u5B50\u7EC4\u4EF6\u7684\u7EC4\u4EF6\u65F6\u6E32\u67D3\u7ED3\u679C\u533A\u522B\u65F6\uFF0C\u5728\u5B58\u5728\u5B50\u7EC4\u4EF6\u7684\u60C5\u51B5\u4E0B\uFF0C<code>shallowMount</code>\u6302\u8F7D\u4F1A\u81EA\u52A8\u5C06\u5B50\u7EC4\u4EF6\u6E32\u67D3\u6210\u5B58\u6839\u7EC4\u4EF6<code>componentname-stub</code>\u3002</p><p>\u8FD9\u4E00\u884C\u4E3A\u76F8\u5F53\u4E8E\uFF1A</p><div class="language-js"><pre><code><span class="token function">shallowMount</span><span class="token punctuation">(</span>Component<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">stubs</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">childComponent</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// \u9ED8\u8BA4\u5B58\u6839\u662F \`&lt;\${component name }-stub&gt;\`</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>\u5F53\u7136\u4F60\u4E5F\u53EF\u4EE5\u4F20\u5165\u4E00\u4E2A\u7279\u5B9A\u7684\u5B9E\u73B0\u4F5C\u4E3A\u5B58\u6839\uFF0C\u5373\u544A\u8BC9 shallowMount \u6302\u8F7D\u7EC4\u4EF6\u65F6\u5BF9\u67D0\u5B50\u7EC4\u4EF6\u4EE5<code>stubs</code>\u4E2D\u6307\u5B9A\u7684\u6620\u5C04\u6765\u5B9E\u73B0\u3002</p><div class="language-js"><pre><code><span class="token keyword">import</span> Foo <span class="token keyword">from</span> <span class="token string">&#39;./Foo.vue&#39;</span>
<span class="token function">shallowMount</span><span class="token punctuation">(</span>Component<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">stubs</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">childComponent</span><span class="token operator">:</span> Foo<span class="token punctuation">,</span> <span class="token comment">// \u6307\u5B9A\u5185\u90E8\u5B50\u7EC4\u4EF6 childComponent \u4EE5 Foo \u7EC4\u4EF6\u6765\u6A21\u62DF\u3002</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>\u6240\u4EE5\u4E0A\u8FF0\u8DEF\u7531\u5BFC\u822A\u7EC4\u4EF6\u7684\u8BBE\u7F6E <code>RouterLink: RouterLinkStub</code> \u5373\u8868\u660E\u5185\u90E8\u7684 <code>RounterLink</code> \u4F7F\u7528\u6A21\u62DF\u7684 <code>RouterLinkStub</code> \u6765\u5B58\u6839\uFF0C\u8FD9\u6837\u6211\u4EEC\u5BF9\u771F\u5B9E <code>RouterLink</code> \u7684\u65AD\u8A00\u53EF\u4EE5\u8F6C\u5AC1\u5230 <code>RouterLinkStub</code> \u6A21\u62DF\u7EC4\u4EF6\u4E0A\u3002<code>RouterLinkStub</code> \u57FA\u672C\u63D0\u4F9B\u4E86 <code>RouterLink</code> \u5C5E\u6027\u548C\u65B9\u6CD5\u4E00\u81F4\u7684\u5B9E\u73B0\u3002</p><h2 id="\u603B\u7ED3" tabindex="-1">\u603B\u7ED3 <a class="header-anchor" href="#\u603B\u7ED3" aria-hidden="true">#</a></h2><ul><li>\u4E0D\u5EFA\u8BAE\u521B\u9020\u771F\u5B9E\u7684 router \u5B9E\u4F8B\u6765\u8FDB\u884C\u5355\u5143\u6D4B\u8BD5\uFF0C\u5B83\u7684\u529F\u80FD\u5E94\u8BE5\u5728\u96C6\u6210\u6D4B\u8BD5\u4E2D\u8FDB\u884C\u3002</li><li>\u4F7F\u7528 <code>mocks</code> \u6765\u6A21\u62DF <code>$route / $router</code> \u5BF9\u8C61\u8FDB\u884C\u65AD\u8A00\u3002</li><li>\u901A\u8FC7 <code>stubs</code> \u9009\u9879\u914D\u7F6E\u8DEF\u7531\u5BFC\u822A <code>RouterLink</code> \u7684\u6A21\u62DF\u7EC4\u4EF6 <code>RouterLinkStub</code> \u6765\u8FDB\u884C\u65AD\u8A00\u3002</li></ul>`,46),e=[o];function c(u,l,k,i,r,d){return a(),s("div",null,e)}var y=n(p,[["render",c]]);export{m as __pageData,y as default};
